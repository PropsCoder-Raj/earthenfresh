(self.webpackChunkearthenfresh=self.webpackChunkearthenfresh||[]).push([[3809],{3809:(e,t,s)=>{"use strict";s.d(t,{Y:()=>T});var o=s(4762),i=s(3018),r=s(7823),n=s(1450),a=s(7558),h=s(6674),d=s(5767),l=s(8583),c=s(3679);function p(e,t){1&e&&(i.TgZ(0,"ion-title",17),i._uU(1,"Add Address"),i.qZA())}function u(e,t){1&e&&(i.TgZ(0,"ion-title",17),i._uU(1,"Update Address"),i.qZA())}function g(e,t){if(1&e){const e=i.EpF();i.ynx(0),i.TgZ(1,"label",18),i.TgZ(2,"input",19),i.NdJ("change",function(t){return i.CHM(e),i.oxw().contentType(t)}),i.qZA(),i._uU(3),i.qZA(),i.BQk()}if(2&e){const e=t.$implicit,s=t.index;i.xp6(2),i.MGl("id","optionsRadios",s+1,""),i.s9C("value",e.name),i.xp6(1),i.hij(" \xa0",e.name," ")}}const m=function(){return{standalone:!0}};function y(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"ion-item",5),i.TgZ(1,"ion-label",6),i._uU(2,"Save As"),i.qZA(),i.TgZ(3,"ion-input",20),i.NdJ("ngModelChange",function(t){return i.CHM(e),i.oxw().otherType=t}),i.qZA(),i.qZA()}if(2&e){const e=i.oxw();i.xp6(3),i.Q6J("ngModel",e.otherType)("ngModelOptions",i.DdM(2,m))}}function f(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"ion-button",21),i.NdJ("click",function(){return i.CHM(e),i.oxw().createAddress()}),i._uU(1,"SUBMIT"),i.qZA()}}function A(e,t){if(1&e){const e=i.EpF();i.TgZ(0,"ion-button",21),i.NdJ("click",function(){return i.CHM(e),i.oxw().updateAddress()}),i._uU(1,"SUBMIT"),i.qZA()}}let T=(()=>{class e{constructor(e,t,s,o,i,r){this.modalController=e,this.route=t,this.userS=s,this.authS=o,this.toastController=i,this.apiS=r,this.edit=!1,this.house_flat_floor_no="",this.apartment_road_area="",this.landmark="",this.city="",this.type="",this.otherType="",this.addressId="",this.otherArray=[],this.arr=[{name:"Home",checked:!1},{name:"Work",checked:!1},{name:"Other",checked:!1}],this.pincodesArr=[]}ngOnInit(){"update"==this.action?(this.edit=!0,this.house_flat_floor_no=this.data.house_flat_floor_no,this.apartment_road_area=this.data.apartment_road_area,this.landmark=this.data.landmark,this.city=this.data.city,this.pincode=this.data.pincode,this.type=this.data.type,"Home"!==this.type&&"Work"!==this.type&&(this.otherType=this.type,this.type="Other"),this.addressId=this.data._id,this.getAddressWhenUpdate(),setTimeout(()=>{$('input:radio[name="optionsRadios"]').filter('[value="'+this.type+'"]').attr("checked",!0)},500)):(this.getAddress(),this.getPincode())}getPincode(){return(0,o.mG)(this,void 0,void 0,function*(){this.apiS.getProfileInfo().subscribe(e=>{this.pincodesArr=e.data.postCodes})})}getAddress(){return(0,o.mG)(this,void 0,void 0,function*(){let e=0,t=0,s=0;this.userS.getAddresses(this.authS.currentUserValue.id).subscribe(o=>{if("success"===o.status&&null!==o.data){o.data.forEach(o=>{s++,"Home"===o.type?e++:"Work"===o.type?t++:"Home"!==o.type&&"Work"!==o.type&&this.otherArray.push({name:o.type})});let i=setInterval(()=>{o.data.length===s&&(clearInterval(i),e>0&&0==t?this.arr=[{name:"Work",checked:!1},{name:"Other",checked:!1}]:0==e&&t>0?this.arr=[{name:"Home",checked:!1},{name:"Other",checked:!1}]:e>0&&t>0&&(this.arr=[{name:"Other",checked:!1}]))})}})})}getAddressWhenUpdate(){return(0,o.mG)(this,void 0,void 0,function*(){let e=0,t=0,s=0;this.otherArray=[],this.userS.getAddresses(this.authS.currentUserValue.id).subscribe(o=>{if("success"===o.status&&null!==o.data){o.data.forEach(o=>{s++,"Home"===o.type?e++:"Work"===o.type?t++:"Home"!==o.type&&"Work"!==o.type&&this.otherArray.push({name:o.type})});let i=setInterval(()=>{o.data.length===s&&(clearInterval(i),"Home"===this.type&&t>0?this.arr=[{name:"Home",checked:!1},{name:"Other",checked:!1}]:"Home"===this.type||"Work"===this.type&&0==t?this.arr=[{name:"Home",checked:!1},{name:"Work",checked:!1},{name:"Other",checked:!1}]:"Work"===this.type&&e>0?this.arr=[{name:"Work",checked:!1},{name:"Other",checked:!1}]:"Other"===this.type&&0==t&&0==e?this.arr=[{name:"Home",checked:!1},{name:"Work",checked:!1},{name:"Other",checked:!1}]:"Other"===this.type&&t>0&&0==e?this.arr=[{name:"Home",checked:!1},{name:"Other",checked:!1}]:"Other"===this.type&&0==t&&e>0&&(this.arr=[{name:"Work",checked:!1},{name:"Other",checked:!1}]))})}})})}closeModal(){this.modalController.dismiss({dismissed:!0})}contentType(e){for(var t=document.getElementsByName("optionsRadios"),s=0,o=t.length;s<o;s++)if(t[s].checked){this.type=t[s].value;break}}createAddress(){if(""!==this.house_flat_floor_no&&""!==this.apartment_road_area&&""!==this.landmark&&""!==this.city&&0!==this.pincode&&""!==this.type)if("Other"===this.type){let e=0;new Promise((t,s)=>{this.otherArray.length>0?this.otherArray.forEach((s,o,i)=>{s.name.toLowerCase()===this.otherType.toLowerCase()&&e++,o===i.length-1&&t()}):("home"!==this.otherType.toLowerCase()&&"work"!==this.otherType.toLowerCase()||e++,t())}).then(()=>{0===e?""!==this.otherType?(this.type=this.otherType,new Promise((e,t)=>{let s=0;new Promise((e,t)=>{this.pincodesArr.forEach((t,o,i)=>{Number(t)===this.pincode&&s++,o===i.length-1&&e()})}).then(()=>{s>0?e():t()})}).then(()=>{this.userS.createUserAddress(this.authS.currentUserValue.id,this.house_flat_floor_no,this.apartment_road_area,this.landmark,this.city,this.pincode,this.type).subscribe(e=>{"success"===e.status&&(this.successToast(e.message),this.modalController.dismiss({dismissed:!0,message:"create"}))})}).catch(()=>{this.errorToast("Sorry, delivery is not available at your location yet")})):this.errorToast("All Fields Mendatory"):"home"===this.otherType.toLowerCase()||"work"===this.otherType.toLowerCase()?this.errorToast(this.otherType+" Select Option OR Address Title Already Use."):this.errorToast("Address Title Already Use.")})}else new Promise((e,t)=>{let s=0;new Promise((e,t)=>{this.pincodesArr.forEach((t,o,i)=>{Number(t)===this.pincode&&s++,o===i.length-1&&e()})}).then(()=>{s>0?e():t()})}).then(()=>{this.userS.createUserAddress(this.authS.currentUserValue.id,this.house_flat_floor_no,this.apartment_road_area,this.landmark,this.city,this.pincode,this.type).subscribe(e=>{"success"===e.status&&(this.successToast(e.message),this.modalController.dismiss({dismissed:!0,message:"create"}))})}).catch(()=>{this.errorToast("Sorry, delivery is not available at your location yet")});else this.errorToast("All Fields Mendatory")}searchArray(){this.otherArray.forEach(e=>{if(e.name==this.type)return!0})}updateAddress(){if(""!==this.house_flat_floor_no&&""!==this.apartment_road_area&&""!==this.landmark&&""!==this.city&&0!==this.pincode&&""!==this.type)if("Other"===this.type){let e=0;new Promise((t,s)=>{this.otherArray.length>0?this.otherArray.forEach((s,o,i)=>{s.name.toLowerCase()===this.otherType.toLowerCase()&&e++,o===i.length-1&&t()}):("home"!==this.otherType.toLowerCase()&&"work"!==this.otherType.toLowerCase()||e++,t())}).then(()=>{0===e?""!==this.otherType?(this.type=this.otherType,this.userS.updateUserAddress(this.addressId,this.house_flat_floor_no,this.apartment_road_area,this.landmark,this.city,this.pincode,this.type).subscribe(e=>{"success"===e.status&&(this.successToast(e.message),this.modalController.dismiss({dismissed:!0,message:"update"}))})):this.errorToast("All Fields Mendatory"):"home"===this.otherType.toLowerCase()||"work"===this.otherType.toLowerCase()?this.errorToast(this.otherType+" Select Option OR Address Title Already Use."):this.errorToast("Address Title Already Use.")})}else this.userS.updateUserAddress(this.addressId,this.house_flat_floor_no,this.apartment_road_area,this.landmark,this.city,this.pincode,this.type).subscribe(e=>{"success"===e.status&&(this.successToast(e.message),this.modalController.dismiss({dismissed:!0,message:"update"}))});else this.errorToast("All Fields Mendatory")}successToast(e){return(0,o.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({color:"primary",message:e,duration:2e3})).present()})}errorToast(e){return(0,o.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({color:"danger",message:e,duration:2e3})).present()})}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(r.IN),i.Y36(n.gz),i.Y36(a.K),i.Y36(h.e),i.Y36(r.yF),i.Y36(d.s))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-address-bread"]],inputs:{action:"action",data:"data"},decls:38,vars:21,consts:[[1,"ion-no-border"],["color","primary"],["class","ion-text-center",4,"ngIf"],["slot","end"],["fill","clear","color","light",2,"font-weight","600",3,"click"],[2,"margin-bottom","10px"],["position","stacked"],["type","text","placeholder","Enter House / Flat / Floor No.",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","placeholder","Enter Apartment / Road / Area",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","placeholder","Enter landmark",3,"ngModel","ngModelOptions","ngModelChange"],["type","text","placeholder","Enter city",3,"ngModel","ngModelOptions","ngModelChange"],["type","number","placeholder","Enter pincode",3,"ngModel","ngModelOptions","ngModelChange"],["lines","none"],[1,"radio",2,"margin-top","unset","position","unset","display","inline"],[4,"ngFor","ngForOf"],["style","margin-bottom: 10px;",4,"ngIf"],["mode","ios","expand","block","class","update-btn",3,"click",4,"ngIf"],[1,"ion-text-center"],[2,"margin-left","20px"],["type","radio","name","optionsRadios",3,"id","value","change"],["type","text","placeholder","Enter Other Specific",3,"ngModel","ngModelOptions","ngModelChange"],["mode","ios","expand","block",1,"update-btn",3,"click"]],template:function(e,t){1&e&&(i.TgZ(0,"ion-header",0),i.TgZ(1,"ion-toolbar",1),i.YNc(2,p,2,0,"ion-title",2),i.YNc(3,u,2,0,"ion-title",2),i.TgZ(4,"ion-buttons",3),i.TgZ(5,"ion-button",4),i.NdJ("click",function(){return t.closeModal()}),i._uU(6,"Close"),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"ion-content"),i.TgZ(8,"ion-item",5),i.TgZ(9,"ion-label",6),i._uU(10,"House / Flat / Floor No."),i.qZA(),i.TgZ(11,"ion-input",7),i.NdJ("ngModelChange",function(e){return t.house_flat_floor_no=e}),i.qZA(),i.qZA(),i.TgZ(12,"ion-item",5),i.TgZ(13,"ion-label",6),i._uU(14,"Apartment / Road / Area"),i.qZA(),i.TgZ(15,"ion-input",8),i.NdJ("ngModelChange",function(e){return t.apartment_road_area=e}),i.qZA(),i.qZA(),i.TgZ(16,"ion-item",5),i.TgZ(17,"ion-label",6),i._uU(18,"Landmark"),i.qZA(),i.TgZ(19,"ion-input",9),i.NdJ("ngModelChange",function(e){return t.landmark=e}),i.qZA(),i.qZA(),i.TgZ(20,"ion-item",5),i.TgZ(21,"ion-label",6),i._uU(22,"City"),i.qZA(),i.TgZ(23,"ion-input",10),i.NdJ("ngModelChange",function(e){return t.city=e}),i.qZA(),i.qZA(),i.TgZ(24,"ion-item",5),i.TgZ(25,"ion-label",6),i._uU(26,"Pincode"),i.qZA(),i.TgZ(27,"ion-input",11),i.NdJ("ngModelChange",function(e){return t.pincode=e}),i.qZA(),i.qZA(),i.TgZ(28,"ion-item",12),i.TgZ(29,"ion-label",6),i._uU(30,"Save As"),i.qZA(),i.TgZ(31,"div",13),i.YNc(32,g,4,3,"ng-container",14),i.qZA(),i.qZA(),i.YNc(33,y,4,3,"ion-item",15),i.qZA(),i.TgZ(34,"ion-footer",0),i.TgZ(35,"ion-toolbar"),i.YNc(36,f,2,0,"ion-button",16),i.YNc(37,A,2,0,"ion-button",16),i.qZA(),i.qZA()),2&e&&(i.xp6(2),i.Q6J("ngIf",!t.edit),i.xp6(1),i.Q6J("ngIf",t.edit),i.xp6(8),i.Q6J("ngModel",t.house_flat_floor_no)("ngModelOptions",i.DdM(16,m)),i.xp6(4),i.Q6J("ngModel",t.apartment_road_area)("ngModelOptions",i.DdM(17,m)),i.xp6(4),i.Q6J("ngModel",t.landmark)("ngModelOptions",i.DdM(18,m)),i.xp6(4),i.Q6J("ngModel",t.city)("ngModelOptions",i.DdM(19,m)),i.xp6(4),i.Q6J("ngModel",t.pincode)("ngModelOptions",i.DdM(20,m)),i.xp6(5),i.Q6J("ngForOf",t.arr),i.xp6(1),i.Q6J("ngIf","Other"===t.type),i.xp6(3),i.Q6J("ngIf",!t.edit),i.xp6(1),i.Q6J("ngIf",t.edit))},directives:[r.Gu,r.sr,l.O5,r.Sm,r.YG,r.W2,r.Ie,r.Q$,r.pK,r.j9,c.JJ,c.On,r.as,l.sg,r.fr,r.wd],styles:['input[type=radio][_ngcontent-%COMP%]:after{background-color:#d1d3d1}input[type=radio][_ngcontent-%COMP%]:after, input[type=radio][_ngcontent-%COMP%]:checked:after{width:13px;height:13px;border-radius:15px;top:-2px;left:-1px;position:relative;content:"";display:inline-block;visibility:visible;border:2px solid #fff}input[type=radio][_ngcontent-%COMP%]:checked:after{background-color:#8abc72}']}),e})()}}]);